# SebeJJ 战斗系统测试用例

## 文档信息

| 项目 | 内容 |
|------|------|
| 所属模块 | 战斗系统 (Combat System) |
| 测试类型 | 功能测试、集成测试、性能测试 |
| 优先级 | P0 - 核心系统 |
| 关联需求 | WEEK2_PLAN.md Day 9-10, 14 |

---

## 测试用例统计

| 类别 | 用例数 | 优先级分布 |
|------|--------|------------|
| 伤害系统 | 18 | P0: 12, P1: 6 |
| 投射物系统 | 15 | P0: 10, P1: 5 |
| 战斗反馈 | 12 | P0: 8, P1: 4 |
| 战斗集成 | 10 | P0: 6, P1: 4 |
| **总计** | **55** | **P0: 36, P1: 19** |

---

## 一、伤害系统测试 (COMBAT-DMG)

### COMBAT-DMG-001: IDamageable 接口实现验证
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 实现 IDamageable 接口的测试类已创建 |
| **测试步骤** | 1. 创建实现 IDamageable 的测试对象<br>2. 调用 TakeDamage() 方法<br>3. 验证 IsAlive 属性<br>4. 调用 Heal() 方法 |
| **预期结果** | 1. TakeDamage 正确减少生命值<br>2. IsAlive 在生命值为0时返回 false<br>3. Heal 正确恢复生命值且不超过上限 |
| **测试数据** | DamageInfo { amount: 20, type: Physical } |

### COMBAT-DMG-002: 基础伤害计算
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageSystem 已初始化 |
| **测试步骤** | 1. 设置基础伤害值 50<br>2. 调用 CalculateDamage()<br>3. 验证返回伤害值 |
| **预期结果** | 返回伤害值等于基础伤害值 |
| **测试数据** | baseDamage: 50, armor: 0, resistance: 0 |

### COMBAT-DMG-003: 护甲减伤计算
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageSystem 已初始化 |
| **测试步骤** | 1. 设置基础伤害 100，护甲 20<br>2. 调用 CalculateDamage()<br>3. 验证减伤后伤害值 |
| **预期结果** | 实际伤害 = 基础伤害 - 护甲值 (最低为1) |
| **测试数据** | baseDamage: 100, armor: 20 → expected: 80 |

### COMBAT-DMG-004: 物理伤害类型
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有物理抗性属性 |
| **测试步骤** | 1. 创建 Physical 类型伤害<br>2. 应用到具有不同物理抗性的目标<br>3. 验证伤害计算 |
| **预期结果** | 物理抗性正确减免物理伤害 |
| **测试数据** | damage: 100, physResistance: 0.3 → expected: 70 |

### COMBAT-DMG-005: 能量伤害类型
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有能量抗性属性 |
| **测试步骤** | 1. 创建 Energy 类型伤害<br>2. 应用到具有不同能量抗性的目标<br>3. 验证伤害计算 |
| **预期结果** | 能量抗性正确减免能量伤害 |
| **测试数据** | damage: 100, energyResistance: 0.5 → expected: 50 |

### COMBAT-DMG-006: 爆炸伤害类型
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有爆炸抗性属性 |
| **测试步骤** | 1. 创建 Explosive 类型伤害<br>2. 应用到具有不同爆炸抗性的目标<br>3. 验证伤害计算 |
| **预期结果** | 爆炸抗性正确减免爆炸伤害 |
| **测试数据** | damage: 100, explosiveResistance: 0.2 → expected: 80 |

### COMBAT-DMG-007: 压强伤害类型
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标处于深水区域 |
| **测试步骤** | 1. 创建 Pressure 类型伤害<br>2. 应用到目标<br>3. 验证伤害计算 |
| **预期结果** | 压强抗性正确减免压强伤害 |
| **测试数据** | damage: 10/s, pressureResistance: 0.5 → expected: 5/s |

### COMBAT-DMG-008: 腐蚀伤害类型
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有腐蚀抗性属性 |
| **测试步骤** | 1. 创建 Corrosive 类型伤害<br>2. 应用到目标<br>3. 验证持续伤害效果 |
| **预期结果** | 腐蚀抗性正确减免腐蚀伤害，可能附带持续伤害效果 |
| **测试数据** | damage: 5/s, duration: 5s, corrosiveResistance: 0.4 |

### COMBAT-DMG-009: 暴击伤害计算
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageSystem 已初始化，暴击倍率为 2.0x |
| **测试步骤** | 1. 创建暴击伤害信息 (isCritical: true)<br>2. 调用 CalculateDamage()<br>3. 验证暴击倍率应用 |
| **预期结果** | 暴击时伤害 = 基础伤害 × 暴击倍率 |
| **测试数据** | baseDamage: 50, critMultiplier: 2.0 → expected: 100 |

### COMBAT-DMG-010: 弱点伤害加成
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有弱点区域定义 |
| **测试步骤** | 1. 命中弱点区域<br>2. 验证弱点伤害加成<br>3. 命中非弱点区域验证正常伤害 |
| **预期结果** | 弱点区域伤害 = 基础伤害 × 弱点倍率 |
| **测试数据** | baseDamage: 50, weakPointMultiplier: 1.5 → expected: 75 |

### COMBAT-DMG-011: 伤害方向击退效果
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标具有刚体组件 |
| **测试步骤** | 1. 创建带方向的伤害信息<br>2. 应用到目标<br>3. 验证目标击退方向和距离 |
| **预期结果** | 目标沿伤害反方向被击退，距离与伤害值相关 |
| **测试数据** | damage: 50, direction: (1, 0), knockbackForce: 10 |

### COMBAT-DMG-012: 伤害来源追踪
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageInfo 包含 source 字段 |
| **测试步骤** | 1. 创建带来源的伤害信息<br>2. 应用到目标<br>3. 验证伤害来源正确记录 |
| **预期结果** | 伤害事件正确记录伤害来源 GameObject |
| **测试数据** | source: Player GameObject |

### COMBAT-DMG-013: 死亡事件触发
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标生命值接近0 |
| **测试步骤** | 1. 订阅 OnDeath 事件<br>2. 造成致命伤害<br>3. 验证事件触发 |
| **预期结果** | 生命值为0时正确触发 OnDeath 事件 |
| **测试数据** | health: 10, damage: 15 |

### COMBAT-DMG-014: 伤害免疫状态
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标处于无敌/免疫状态 |
| **测试步骤** | 1. 激活目标免疫状态<br>2. 尝试造成伤害<br>3. 验证生命值不变 |
| **预期结果** | 免疫状态下不受任何伤害 |
| **测试数据** | damage: 100, isInvulnerable: true |

### COMBAT-DMG-015: 伤害数字显示
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageNumberUI 系统已初始化 |
| **测试步骤** | 1. 造成伤害<br>2. 验证伤害数字UI出现<br>3. 验证数字颜色/大小随伤害类型变化 |
| **预期结果** | 伤害数字正确显示在目标位置，样式符合伤害类型 |
| **测试数据** | damage: 50, type: Critical |

### COMBAT-DMG-016: 治疗系统
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标生命值不满 |
| **测试步骤** | 1. 调用 Heal() 方法<br>2. 验证生命值增加<br>3. 验证不超过最大生命值 |
| **预期结果** | 治疗正确恢复生命值，溢出治疗被忽略 |
| **测试数据** | health: 50, maxHealth: 100, heal: 30 → expected: 80 |

### COMBAT-DMG-017: 治疗溢出处理
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标生命值接近满值 |
| **测试步骤** | 1. 设置当前生命值 90，最大值 100<br>2. 治疗 20 点<br>3. 验证生命值不超过最大值 |
| **预期结果** | 生命值上限为 maxHealth，溢出部分被丢弃 |
| **测试数据** | health: 90, maxHealth: 100, heal: 20 → expected: 100 |

### COMBAT-DMG-018: 持续伤害(DOT)效果
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DOT 系统已初始化 |
| **测试步骤** | 1. 应用 DOT 效果<br>2. 等待多个 tick<br>3. 验证每次伤害和时间间隔 |
| **预期结果** | DOT 按设定间隔持续造成伤害，持续指定时间 |
| **测试数据** | damagePerTick: 5, tickInterval: 1s, duration: 5s |

---

## 二、投射物系统测试 (COMBAT-PRJ)

### COMBAT-PRJ-001: 投射物基础飞行
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | Projectile 预制体已创建 |
| **测试步骤** | 1. 实例化投射物<br>2. 设置速度和方向<br>3. 验证飞行轨迹 |
| **预期结果** | 投射物沿设定方向直线飞行，速度恒定 |
| **测试数据** | speed: 10, direction: (1, 0) |

### COMBAT-PRJ-002: 投射物生命周期
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物已发射 |
| **测试步骤** | 1. 发射投射物<br>2. 等待超过最大生命周期<br>3. 验证投射物销毁 |
| **预期结果** | 投射物在超过 maxLifetime 后自动销毁 |
| **测试数据** | maxLifetime: 5s |

### COMBAT-PRJ-003: 投射物碰撞检测
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景中有可碰撞目标 |
| **测试步骤** | 1. 发射投射物<br>2. 命中目标<br>3. 验证碰撞事件触发 |
| **预期结果** | 投射物命中目标时触发 OnHit 事件 |
| **测试数据** | target: Enemy with Collider2D |

### COMBAT-PRJ-004: 投射物伤害传递
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标实现 IDamageable 接口 |
| **测试步骤** | 1. 发射投射物<br>2. 命中目标<br>3. 验证目标受到伤害 |
| **预期结果** | 命中时正确传递伤害值给目标 |
| **测试数据** | projectileDamage: 50 |

### COMBAT-PRJ-005: 投射物友军伤害设置
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物有 team/layer 设置 |
| **测试步骤** | 1. 发射友方投射物<br>2. 命中友方目标<br>3. 验证是否造成伤害（根据设置） |
| **预期结果** | 根据 friendlyFire 设置决定是否造成伤害 |
| **测试数据** | friendlyFire: false → no damage to ally |

### COMBAT-PRJ-006: 投射物穿透效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物设置穿透次数 > 0 |
| **测试步骤** | 1. 发射穿透投射物<br>2. 穿透多个目标<br>3. 验证每个目标受伤且投射物继续飞行 |
| **预期结果** | 投射物穿透指定次数后才销毁 |
| **测试数据** | pierceCount: 3, targets: 5 |

### COMBAT-PRJ-007: 投射物反弹效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物设置可反弹 |
| **测试步骤** | 1. 发射反弹投射物<br>2. 命中墙壁<br>3. 验证反弹方向和次数 |
| **预期结果** | 投射物按物理规律反弹，反弹次数耗尽后销毁 |
| **测试数据** | bounceCount: 2 |

### COMBAT-PRJ-008: 投射物追踪效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物设置追踪，场景中有目标 |
| **测试步骤** | 1. 发射追踪投射物<br>2. 目标移动<br>3. 验证投射物调整方向追踪目标 |
| **预期结果** | 投射物持续调整方向朝向目标 |
| **测试数据** | homingStrength: 5.0 |

### COMBAT-PRJ-009: 投射物范围爆炸
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物设置爆炸半径 |
| **测试步骤** | 1. 发射爆炸投射物<br>2. 命中目标或地面<br>3. 验证范围内所有目标受伤 |
| **预期结果** | 爆炸范围内所有有效目标受到伤害 |
| **测试数据** | explosionRadius: 5, damage: 80 |

### COMBAT-PRJ-010: 投射物爆炸伤害衰减
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 爆炸投射物设置伤害衰减 |
| **测试步骤** | 1. 触发爆炸<br>2. 测量不同距离目标受到的伤害<br>3. 验证距离越远伤害越低 |
| **预期结果** | 爆炸伤害随距离增加而衰减 |
| **测试数据** | center: 100, edge: 50 |

### COMBAT-PRJ-011: 投射物对象池回收
**优先级:** P0 | **类型:** 性能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | ObjectPool 系统已配置 |
| **测试步骤** | 1. 发射投射物<br>2. 投射物命中/超时<br>3. 验证投射物回收到对象池 |
| **预期结果** | 投射物正确回收到对象池供复用 |
| **测试数据** | poolSize: 50 |

### COMBAT-PRJ-012: 连续射击投射物生成
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 武器系统已配置自动射击 |
| **测试步骤** | 1. 按住射击键<br>2. 验证投射物按射速间隔生成<br>3. 验证投射物不重叠 |
| **预期结果** | 投射物以正确间隔生成，位置不重叠 |
| **测试数据** | fireRate: 5/s |

### COMBAT-PRJ-013: 投射物与场景边界
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景有边界碰撞体 |
| **测试步骤** | 1. 发射投射物<br>2. 投射物飞出场景边界<br>3. 验证投射物销毁 |
| **预期结果** | 投射物飞出边界后自动销毁 |
| **测试数据** | sceneBounds: ±100 |

### COMBAT-PRJ-014: 投射物视觉效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 投射物配置了 Trail/Particle |
| **测试步骤** | 1. 发射投射物<br>2. 验证尾迹效果<br>3. 命中时验证命中特效 |
| **预期结果** | 投射物飞行和命中时正确显示视觉效果 |
| **测试数据** | trailPrefab, hitEffectPrefab |

### COMBAT-PRJ-015: 投射物性能压力测试
**优先级:** P1 | **类型:** 性能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 性能监控已启用 |
| **测试步骤** | 1. 同时生成 100+ 投射物<br>2. 监控帧率<br>3. 验证性能达标 |
| **预期结果** | 大量投射物时帧率保持在 30 FPS 以上 |
| **测试数据** | projectileCount: 100, targetFPS: 30 |

---

## 三、战斗反馈测试 (COMBAT-FDB)

### COMBAT-FDB-001: 屏幕震动效果
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | ScreenShake 系统已配置 |
| **测试步骤** | 1. 触发屏幕震动<br>2. 验证相机位置变化<br>3. 验证震动衰减 |
| **预期结果** | 相机按设定强度和时长震动，逐渐衰减 |
| **测试数据** | intensity: 0.5, duration: 0.3s |

### COMBAT-FDB-002: 屏幕震动强度分级
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 不同震动强度配置 |
| **测试步骤** | 1. 触发不同强度的震动<br>2. 验证震动幅度差异 |
| **预期结果** | 轻/中/重伤害对应不同震动强度 |
| **测试数据** | light: 0.2, medium: 0.5, heavy: 1.0 |

### COMBAT-FDB-003: 命中停顿(Hit Stop)
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | HitStop 系统已配置 |
| **测试步骤** | 1. 命中目标<br>2. 验证游戏短暂停顿<br>3. 验证停顿后恢复 |
| **预期结果** | 命中时游戏短暂冻结，增强打击感 |
| **测试数据** | stopDuration: 0.05s |

### COMBAT-FDB-004: 受伤闪烁效果
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标有 SpriteRenderer |
| **测试步骤** | 1. 目标受到伤害<br>2. 验证精灵闪烁<br>3. 验证闪烁后恢复正常 |
| **预期结果** | 受伤时精灵变白/红闪烁，持续指定时间 |
| **测试数据** | flashDuration: 0.1s, flashColor: white |

### COMBAT-FDB-005: 受伤动画触发
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标有 Animator 组件 |
| **测试步骤** | 1. 目标受到伤害<br>2. 验证受伤动画触发<br>3. 验证动画过渡到 idle |
| **预期结果** | 受伤时播放受伤动画，完成后回到 idle |
| **测试数据** | hurtTrigger: "Hurt" |

### COMBAT-FDB-006: 死亡动画触发
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 目标有死亡动画 |
| **测试步骤** | 1. 造成致命伤害<br>2. 验证死亡动画播放<br>3. 验证动画完成后销毁 |
| **预期结果** | 死亡时播放死亡动画，完成后清理对象 |
| **测试数据** | deathTrigger: "Death" |

### COMBAT-FDB-007: 音效播放
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | AudioManager 已配置 |
| **测试步骤** | 1. 触发不同战斗事件<br>2. 验证对应音效播放 |
| **预期结果** | 射击、命中、爆炸等事件播放正确音效 |
| **测试数据** | shootSFX, hitSFX, explodeSFX |

### COMBAT-FDB-008: 粒子特效播放
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 特效预制体已配置 |
| **测试步骤** | 1. 触发战斗事件<br>2. 验证粒子特效生成<br>3. 验证特效自动清理 |
| **预期结果** | 命中、爆炸等事件播放对应粒子特效 |
| **测试数据** | muzzleFlash, hitSparks, explosion |

### COMBAT-FDB-009: 准星反馈
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | UI 准星已配置 |
| **测试步骤** | 1. 瞄准敌人<br>2. 验证准星变化<br>3. 射击时验证准星扩散 |
| **预期结果** | 瞄准敌人时准星变色，射击时准星扩散 |
| **测试数据** | enemyLayer, spreadAmount: 10 |

### COMBAT-FDB-010: 伤害数字动画
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DamageNumber UI 已配置 |
| **测试步骤** | 1. 造成伤害<br>2. 验证数字向上飘动<br>3. 验证数字渐隐消失 |
| **预期结果** | 伤害数字向上飘动并渐隐 |
| **测试数据** | floatSpeed: 50, fadeDuration: 1s |

### COMBAT-FDB-011: 暴击视觉反馈
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 暴击反馈已配置 |
| **测试步骤** | 1. 触发暴击<br>2. 验证暴击特效<br>3. 验证暴击音效 |
| **预期结果** | 暴击时显示更大伤害数字和特殊特效 |
| **测试数据** | critTextScale: 1.5, critColor: yellow |

### COMBAT-FDB-012: 战斗UI更新
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | HUD 已配置 |
| **测试步骤** | 1. 玩家受伤<br>2. 验证血条减少<br>3. 验证能量条变化 |
| **预期结果** | 战斗时 HUD 实时更新生命值和能量 |
| **测试数据** | healthBar, energyBar |

---

## 四、战斗集成测试 (COMBAT-INT)

### COMBAT-INT-001: 完整战斗流程
**优先级:** P0 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家、敌人、武器系统已配置 |
| **测试步骤** | 1. 玩家装备武器<br>2. 瞄准并射击敌人<br>3. 验证伤害计算<br>4. 验证敌人死亡 |
| **预期结果** | 完整战斗流程正常工作 |
| **测试数据** | weapon: MiningLaser, enemy: DeepJellyfish |

### COMBAT-INT-002: 多武器切换战斗
**优先级:** P0 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家装备多种武器 |
| **测试步骤** | 1. 使用武器A射击<br>2. 切换武器B<br>3. 使用武器B射击<br>4. 验证不同武器效果 |
| **预期结果** | 武器切换后正确应用新武器属性 |
| **测试数据** | weapons: [MiningLaser, Harpoon, Torpedo] |

### COMBAT-INT-003: 能量管理与战斗
**优先级:** P0 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家有能量系统 |
| **测试步骤** | 1. 持续射击消耗能量<br>2. 能量耗尽时尝试射击<br>3. 验证无法射击<br>4. 能量恢复后验证可射击 |
| **预期结果** | 能量不足时无法射击，恢复后可继续 |
| **测试数据** | energyCost: 5, maxEnergy: 100 |

### COMBAT-INT-004: 多人战斗场景
**优先级:** P1 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景中有多个敌人 |
| **测试步骤** | 1. 同时与多个敌人战斗<br>2. 验证伤害正确分配<br>3. 验证敌人独立行为 |
| **预期结果** | 多敌人战斗时各系统正常工作 |
| **测试数据** | enemyCount: 5 |

### COMBAT-INT-005: 战斗与存档
**优先级:** P1 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | SaveSystem 已配置 |
| **测试步骤** | 1. 进行战斗<br>2. 中途存档<br>3. 读档<br>4. 验证战斗状态恢复 |
| **预期结果** | 战斗状态正确保存和恢复 |
| **测试数据** | saveSlot: "combat_test" |

### COMBAT-INT-006: 战斗暂停/恢复
**优先级:** P0 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | PauseSystem 已配置 |
| **测试步骤** | 1. 战斗中暂停游戏<br>2. 验证所有战斗行为停止<br>3. 恢复游戏<br>4. 验证战斗继续 |
| **预期结果** | 暂停时战斗完全停止，恢复后继续 |
| **测试数据** | timeScale: 0 → 1 |

### COMBAT-INT-007: 战斗性能基准
**优先级:** P1 | **类型:** 性能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 性能监控已启用 |
| **测试步骤** | 1. 同时存在 20+ 敌人<br>2. 持续战斗 60 秒<br>3. 监控帧率和内存 |
| **预期结果** | 帧率保持在 30 FPS 以上，内存稳定 |
| **测试数据** | enemyCount: 20, duration: 60s |

### COMBAT-INT-008: 边界情况 - 零伤害
**优先级:** P1 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 可配置零伤害武器 |
| **测试步骤** | 1. 配置伤害为 0 的武器<br>2. 射击敌人<br>3. 验证敌人不受伤害 |
| **预期结果** | 零伤害不触发任何伤害效果 |
| **测试数据** | damage: 0 |

### COMBAT-INT-009: 边界情况 - 溢出伤害
**优先级:** P1 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人生命值较低 |
| **测试步骤** | 1. 敌人生命值为 10<br>2. 造成 1000 伤害<br>3. 验证敌人死亡<br>4. 验证无异常 |
| **预期结果** | 溢出伤害正确导致死亡，无异常 |
| **测试数据** | health: 10, damage: 1000 |

### COMBAT-INT-010: 战斗事件广播
**优先级:** P1 | **类型:** 集成测试

| 项目 | 内容 |
|------|------|
| **前置条件** | EventSystem 已配置 |
| **测试步骤** | 1. 订阅战斗相关事件<br>2. 进行各种战斗行为<br>3. 验证事件正确广播 |
| **预期结果** | OnDamageDealt, OnEnemyKilled 等事件正确触发 |
| **测试数据** | events: [OnDamageDealt, OnEnemyKilled, OnWeaponFired] |

---

## 测试数据需求

### 武器测试数据
```json
{
  "weapons": [
    {
      "name": "TestMiningLaser",
      "type": "MiningLaser",
      "damage": 10,
      "fireRate": 10,
      "range": 15,
      "energyCost": 5,
      "damageType": "Energy"
    },
    {
      "name": "TestHarpoon",
      "type": "Harpoon",
      "damage": 50,
      "fireRate": 0.5,
      "range": 20,
      "energyCost": 20,
      "damageType": "Physical"
    },
    {
      "name": "TestTorpedo",
      "type": "Torpedo",
      "damage": 80,
      "fireRate": 0.3,
      "range": 30,
      "energyCost": 40,
      "damageType": "Explosive",
      "explosionRadius": 5
    }
  ]
}
```

### 敌人测试数据
```json
{
  "enemies": [
    {
      "name": "TestJellyfish",
      "maxHealth": 50,
      "armor": 0,
      "resistances": {
        "Physical": 0,
        "Energy": 0.3,
        "Explosive": 0
      },
      "weakPointMultiplier": 1.5
    },
    {
      "name": "TestDrone",
      "maxHealth": 80,
      "armor": 10,
      "resistances": {
        "Physical": 0.2,
        "Energy": 0.1,
        "Explosive": 0.5
      }
    }
  ]
}
```

---

## 自动化测试覆盖

| 测试用例ID | 自动化状态 | 测试文件 |
|------------|------------|----------|
| COMBAT-DMG-001 | ✅ 已覆盖 | DamageSystemTests.cs |
| COMBAT-DMG-002 ~ 018 | ✅ 已覆盖 | DamageSystemTests.cs |
| COMBAT-PRJ-001 ~ 015 | ✅ 已覆盖 | ProjectileSystemTests.cs |
| COMBAT-FDB-001 ~ 012 | ⚠️ 部分覆盖 | CombatFeedbackTests.cs |
| COMBAT-INT-001 ~ 010 | ⚠️ 部分覆盖 | CombatIntegrationTests.cs |

---

**文档版本:** 1.0  
**创建日期:** 2026-02-26  
**作者:** 测试工程师 Agent  
**审核状态:** 待审核
