# SebeJJ 敌人AI测试用例

## 文档信息

| 项目 | 内容 |
|------|------|
| 所属模块 | 敌人AI系统 (Enemy AI System) |
| 测试类型 | 功能测试、行为测试、性能测试 |
| 优先级 | P0 - 核心系统 |
| 关联需求 | WEEK2_PLAN.md Day 11-13 |

---

## 测试用例统计

| 类别 | 用例数 | 优先级分布 |
|------|--------|------------|
| 状态机系统 | 12 | P0: 8, P1: 4 |
| 基础敌人行为 | 15 | P0: 10, P1: 5 |
| 特定敌人类型 | 18 | P0: 12, P1: 6 |
| AI感知系统 | 10 | P0: 6, P1: 4 |
| 战斗AI行为 | 12 | P0: 8, P1: 4 |
| **总计** | **67** | **P0: 44, P1: 23** |

---

## 一、状态机系统测试 (AI-FSM)

### AI-FSM-001: 状态机初始化
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | StateMachine 类已创建 |
| **测试步骤** | 1. 创建 StateMachine 实例<br>2. 添加多个状态<br>3. 验证状态注册成功 |
| **预期结果** | 状态正确添加到状态机字典中 |
| **测试数据** | states: [Idle, Patrol, Chase] |

### AI-FSM-002: 状态切换
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机已初始化，有多个状态 |
| **测试步骤** | 1. 设置初始状态 Idle<br>2. 切换到 Patrol 状态<br>3. 验证状态变更 |
| **预期结果** | 当前状态正确切换，原状态 Exit 被调用，新状态 Enter 被调用 |
| **测试数据** | from: Idle, to: Patrol |

### AI-FSM-003: 状态生命周期
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机正在运行 |
| **测试步骤** | 1. 进入某状态<br>2. 每帧调用 Update<br>3. 退出状态<br>4. 验证生命周期方法调用顺序 |
| **预期结果** | 调用顺序: Enter → Update (多帧) → Exit |
| **测试数据** | duration: 3 frames |

### AI-FSM-004: 状态切换条件验证
**优先级:** P0 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态有切换条件定义 |
| **测试步骤** | 1. 设置状态切换条件<br>2. 条件满足时验证自动切换<br>3. 条件不满足时验证保持当前状态 |
| **预期结果** | 条件满足时自动切换，否则保持当前状态 |
| **测试数据** | condition: playerInRange = true |

### AI-FSM-005: 空状态处理
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机未设置初始状态 |
| **测试步骤** | 1. 创建空状态机<br>2. 调用 Update<br>3. 验证无异常抛出 |
| **预期结果** | 空状态机安全处理，无异常 |
| **测试数据** | currentState: null |

### AI-FSM-006: 状态复用
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机有多个状态 |
| **测试步骤** | 1. A→B→A 状态切换<br>2. 验证状态 A 正确重新初始化 |
| **预期结果** | 状态可重复进入，每次正确执行 Enter |
| **测试数据** | transitions: Idle→Chase→Idle |

### AI-FSM-007: 状态机性能
**优先级:** P1 | **类型:** 性能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 性能监控已启用 |
| **测试步骤** | 1. 创建 100 个状态机<br>2. 每帧更新所有状态机<br>3. 监控性能开销 |
| **预期结果** | 100 个状态机更新耗时 < 1ms |
| **测试数据** | stateMachineCount: 100 |

### AI-FSM-008: 状态事件订阅
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态支持事件订阅 |
| **测试步骤** | 1. 订阅 OnStateEnter/Exit 事件<br>2. 切换状态<br>3. 验证事件触发 |
| **预期结果** | 状态切换时正确触发订阅事件 |
| **测试数据** | subscribers: 3 |

### AI-FSM-009: 状态堆栈（层级状态机）
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机支持状态堆栈 |
| **测试步骤** | 1. Push 状态 A<br>2. Push 状态 B<br>3. Pop 状态<br>4. 验证回到状态 A |
| **预期结果** | 状态堆栈正确管理，Pop 后恢复上一状态 |
| **测试数据** | stack: [Idle, Attack, Stunned] |

### AI-FSM-010: 并行状态
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机支持并行状态 |
| **测试步骤** | 1. 激活移动状态<br>2. 同时激活攻击状态<br>3. 验证两个状态同时更新 |
| **预期结果** | 多个状态可同时活跃并更新 |
| **测试数据** | parallelStates: [Move, Attack] |

### AI-FSM-011: 状态历史记录
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机记录历史 |
| **测试步骤** | 1. 进行多次状态切换<br>2. 查询状态历史<br>3. 验证历史记录正确 |
| **预期结果** | 状态切换历史正确记录 |
| **测试数据** | history: [Idle, Patrol, Chase, Attack] |

### AI-FSM-012: 状态机重置
**优先级:** P1 | **类型:** 单元测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 状态机已运行一段时间 |
| **测试步骤** | 1. 运行状态机<br>2. 调用 Reset<br>3. 验证回到初始状态 |
| **预期结果** | 重置后状态机回到初始状态，历史清空 |
| **测试数据** | resetTo: Idle |

---

## 二、基础敌人行为测试 (AI-BEH)

### AI-BEH-001: Idle 状态行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人处于 Idle 状态 |
| **测试步骤** | 1. 放置敌人<br>2. 观察 Idle 行为<br>3. 验证行为符合预期 |
| **预期结果** | 敌人在原地待机，可能有轻微动画 |
| **测试数据** | idleDuration: random(2-5s) |

### AI-BEH-002: Patrol 状态行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人配置巡逻路径 |
| **测试步骤** | 1. 进入 Patrol 状态<br>2. 验证沿路径移动<br>3. 验证到达路点后转向 |
| **预期结果** | 敌人沿预设路径巡逻，到达路点后继续 |
| **测试数据** | waypoints: [(0,0), (10,0), (10,10), (0,10)] |

### AI-BEH-003: Patrol 路径循环
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人配置闭合巡逻路径 |
| **测试步骤** | 1. 敌人沿路径巡逻<br>2. 到达最后一个路点<br>3. 验证回到第一个路点 |
| **预期结果** | 路径循环播放，无中断 |
| **测试数据** | loopType: Loop/PingPong |

### AI-BEH-004: Chase 状态行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家进入敌人检测范围 |
| **测试步骤** | 1. 玩家接近敌人<br>2. 验证敌人进入 Chase 状态<br>3. 验证敌人向玩家移动 |
| **预期结果** | 检测到玩家后追击，朝玩家位置移动 |
| **测试数据** | detectionRange: 8, chaseSpeed: 4 |

### AI-BEH-005: Chase 丢失目标
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人正在追击玩家 |
| **测试步骤** | 1. 玩家逃离超出检测范围<br>2. 验证敌人丢失目标<br>3. 验证回到 Patrol/Idle |
| **预期结果** | 丢失目标后返回巡逻或待机 |
| **测试数据** | loseTargetTime: 3s |

### AI-BEH-006: Attack 状态行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人进入攻击范围 |
| **测试步骤** | 1. 敌人接近到攻击距离<br>2. 验证进入 Attack 状态<br>3. 验证执行攻击 |
| **预期结果** | 在攻击范围内执行攻击行为 |
| **测试数据** | attackRange: 3, attackCooldown: 2s |

### AI-BEH-007: Attack 冷却时间
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人刚执行过攻击 |
| **测试步骤** | 1. 敌人攻击<br>2. 在冷却期间验证无法攻击<br>3. 冷却后验证可再次攻击 |
| **预期结果** | 攻击遵循冷却时间，冷却期间不能攻击 |
| **测试数据** | attackCooldown: 2s |

### AI-BEH-008: Return 状态行为
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人远离出生点 |
| **测试步骤** | 1. 敌人追击过远<br>2. 验证进入 Return 状态<br>3. 验证返回出生点 |
| **预期结果** | 超出最大追击距离后返回出生点 |
| **测试数据** | maxChaseDistance: 20 |

### AI-BEH-009: Stunned 状态行为
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人可被眩晕 |
| **测试步骤** | 1. 对敌人施加眩晕<br>2. 验证进入 Stunned 状态<br>3. 验证无法行动<br>4. 眩晕结束后恢复正常 |
| **预期结果** | 眩晕期间无法移动或攻击 |
| **测试数据** | stunDuration: 2s |

### AI-BEH-010: Death 状态行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人生命值为 0 |
| **测试步骤** | 1. 击杀敌人<br>2. 验证进入 Death 状态<br>3. 验证播放死亡动画<br>4. 验证掉落物品 |
| **预期结果** | 死亡时播放动画并掉落物品 |
| **测试数据** | deathAnimationDuration: 1s |

### AI-BEH-011: 状态优先级
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有状态优先级配置 |
| **测试步骤** | 1. 同时触发多个状态条件<br>2. 验证高优先级状态被选中 |
| **预期结果** | 高优先级状态覆盖低优先级 |
| **测试数据** | priority: Death > Stunned > Attack > Chase > Patrol > Idle |

### AI-BEH-012: 状态中断
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人正在执行某状态 |
| **测试步骤** | 1. 敌人正在 Attack<br>2. 触发更高优先级条件<br>3. 验证当前状态被中断 |
| **预期结果** | 高优先级事件可中断当前状态 |
| **测试数据** | interruptible: true/false |

### AI-BEH-013: 随机行为变化
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人配置随机行为 |
| **测试步骤** | 1. 多次观察 Idle 行为<br>2. 验证有随机变化 |
| **预期结果** | 行为有合理的随机性，避免机械感 |
| **测试数据** | randomIdleTime: [2-5s] |

### AI-BEH-014: 行为动画同步
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有 Animator 组件 |
| **测试步骤** | 1. 切换各状态<br>2. 验证对应动画触发 |
| **预期结果** | 每个状态正确触发对应动画 |
| **测试数据** | animatorParams: [IsIdle, IsPatrolling, IsChasing, IsAttacking] |

### AI-BEH-015: 行为音效
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | AudioManager 已配置 |
| **测试步骤** | 1. 切换各状态<br>2. 验证对应音效播放 |
| **预期结果** | 状态切换时播放对应音效 |
| **测试数据** | sfx: [idleAmbient, patrolMove, chaseAlert, attackSwing] |

---

## 三、特定敌人类型测试 (AI-ENM)

### DeepJellyfish (深海水母)

#### AI-ENM-JF-001: 漂浮移动
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | DeepJellyfish 已生成 |
| **测试步骤** | 1. 观察水母移动<br>2. 验证上下漂浮效果 |
| **预期结果** | 水母有自然的上下漂浮动画 |
| **测试数据** | floatAmplitude: 0.5, floatSpeed: 1 |

#### AI-ENM-JF-002: 触手攻击
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家进入攻击范围 |
| **测试步骤** | 1. 玩家接近水母<br>2. 验证触手攻击动画<br>3. 验证伤害判定 |
| **预期结果** | 触手攻击有正确范围和伤害 |
| **测试数据** | tentacleRange: 4, tentacleDamage: 15 |

#### AI-ENM-JF-003: 发光效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 水母有发光组件 |
| **测试步骤** | 1. 观察水母<br>2. 验证发光效果<br>3. 验证攻击时发光变化 |
| **预期结果** | 水母有脉动发光效果，攻击时变亮 |
| **测试数据** | glowIntensity: [0.5-1.0] |

#### AI-ENM-JF-004: 被动漂浮AI
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 水母在场景中 |
| **测试步骤** | 1. 放置水母<br>2. 观察 AI 行为<br>3. 验证不主动追击 |
| **预期结果** | 水母被动漂浮，不主动追击玩家 |
| **测试数据** | aggressive: false |

---

### SecurityDrone (安保无人机)

#### AI-ENM-SD-001: 巡逻行为
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 无人机配置巡逻路径 |
| **测试步骤** | 1. 观察无人机巡逻<br>2. 验证按路径移动<br>3. 验证转向平滑 |
| **预期结果** | 无人机按预设路径平滑巡逻 |
| **测试数据** | patrolSpeed: 3, rotationSpeed: 180 |

#### AI-ENM-SD-002: 激光射击
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家进入检测范围 |
| **测试步骤** | 1. 玩家接近无人机<br>2. 验证激光瞄准<br>3. 验证激光射击 |
| **预期结果** | 无人机瞄准并发射激光 |
| **测试数据** | laserRange: 15, laserDamage: 10/s |

#### AI-ENM-SD-003: 警报系统
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景中有多个无人机 |
| **测试步骤** | 1. 触发一个无人机警报<br>2. 验证附近无人机响应<br>3. 验证进入追击状态 |
| **预期结果** | 警报传播给附近敌人 |
| **测试数据** | alertRadius: 20 |

#### AI-ENM-SD-004: 悬停稳定
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 无人机在空中 |
| **测试步骤** | 1. 观察悬停状态<br>2. 验证位置稳定 |
| **预期结果** | 悬停时位置保持稳定 |
| **测试数据** | hoverStability: 0.1 |

---

### AnglerFish (鮟鱇鱼)

#### AI-ENM-AF-001: 伪装待机
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 鮟鱇鱼在场景中 |
| **测试步骤** | 1. 观察待机状态<br>2. 验证伪装效果<br>3. 验证诱饵灯 |
| **预期结果** | 待机时伪装成环境，诱饵灯发光 |
| **测试数据** | camouflageOpacity: 0.3 |

#### AI-ENM-AF-002: 快速冲刺攻击
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家进入触发范围 |
| **测试步骤** | 1. 玩家接近<br>2. 验证冲刺触发<br>3. 验证高速冲向玩家<br>4. 验证造成伤害 |
| **预期结果** | 玩家接近时快速冲刺攻击 |
| **测试数据** | dashSpeed: 15, dashRange: 10 |

#### AI-ENM-AF-003: 诱饵灯效果
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景较暗 |
| **测试步骤** | 1. 观察诱饵灯<br>2. 验证吸引效果 |
| **预期结果** | 诱饵灯吸引玩家靠近 |
| **测试数据** | lureRange: 12 |

#### AI-ENM-AF-004: 攻击后硬直
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 鮟鱇鱼刚完成冲刺 |
| **测试步骤** | 1. 观察冲刺后行为<br>2. 验证短暂硬直<br>3. 验证后可再次攻击 |
| **预期结果** | 冲刺后有短暂恢复期 |
| **测试数据** | recoveryTime: 2s |

---

### DefenseTurret (防御炮塔)

#### AI-ENM-DT-001: 固定位置
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 炮塔已放置 |
| **测试步骤** | 1. 验证炮塔不移动<br>2. 尝试推动炮塔 |
| **预期结果** | 炮塔固定在位置，不可移动 |
| **测试数据** | isStatic: true |

#### AI-ENM-DT-002: 旋转瞄准
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家在检测范围内 |
| **测试步骤** | 1. 玩家移动<br>2. 验证炮塔旋转跟随<br>3. 验证旋转限制 |
| **预期结果** | 炮塔平滑旋转瞄准玩家，受旋转角度限制 |
| **测试数据** | rotationSpeed: 90, maxAngle: 180 |

#### AI-ENM-DT-003: 连发子弹
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家进入射程 |
| **测试步骤** | 1. 玩家进入射程<br>2. 验证连发射击<br>3. 验证射击间隔 |
| **预期结果** | 连续发射多颗子弹，有固定间隔 |
| **测试数据** | burstCount: 3, burstInterval: 0.2s |

#### AI-ENM-DT-004: 射击角度限制
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 炮塔有射击角度限制 |
| **测试步骤** | 1. 玩家在不同角度<br>2. 验证可射击角度<br>3. 验证不可射击角度 |
| **预期结果** | 超出射击角度时无法开火 |
| **测试数据** | fireAngle: ±60 |

---

## 四、AI感知系统测试 (AI-SNS)

### AI-SNS-001: 视觉检测
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有视觉检测组件 |
| **测试步骤** | 1. 玩家在视野内<br>2. 验证检测到玩家<br>3. 玩家离开视野<br>4. 验证丢失检测 |
| **预期结果** | 正确检测视野内玩家 |
| **测试数据** | viewAngle: 120, viewRange: 10 |

### AI-SNS-002: 视觉遮挡
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景有障碍物 |
| **测试步骤** | 1. 玩家在视野内但墙后<br>2. 验证未检测到玩家<br>3. 移除遮挡<br>4. 验证检测到玩家 |
| **预期结果** | 障碍物遮挡时无法检测 |
| **测试数据** | obstacleLayer: Walls |

### AI-SNS-003: 听觉检测
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有听觉检测 |
| **测试步骤** | 1. 玩家发出声音<br>2. 验证敌人听到<br>3. 验证朝声源方向查看 |
| **预期结果** | 听到声音后转向声源 |
| **测试数据** | hearingRange: 15 |

### AI-SNS-004: 伤害感知
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人可被伤害 |
| **测试步骤** | 1. 从背后攻击敌人<br>2. 验证敌人立即转向<br>3. 验证进入战斗状态 |
| **预期结果** | 受到伤害立即感知攻击者 |
| **测试数据** | damageReaction: immediate |

### AI-SNS-005: 记忆系统
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有记忆系统 |
| **测试步骤** | 1. 敌人看到玩家<br>2. 玩家躲藏<br>3. 验证敌人记住最后位置<br>4. 验证前往调查 |
| **预期结果** | 丢失视野后前往最后已知位置 |
| **测试数据** | memoryDuration: 5s |

### AI-SNS-006: 检测冷却
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人刚丢失目标 |
| **测试步骤** | 1. 敌人追击玩家<br>2. 玩家逃离<br>3. 验证检测冷却时间<br>4. 验证不立即重新检测 |
| **预期结果** | 丢失目标后有短暂冷却 |
| **测试数据** | detectionCooldown: 1s |

### AI-SNS-007: 高度/深度检测
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景有高度差 |
| **测试步骤** | 1. 玩家在不同高度<br>2. 验证检测范围变化 |
| **预期结果** | 高度差影响检测范围 |
| **测试数据** | heightFactor: 0.5 |

### AI-SNS-008: 群体感知
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景中有多个敌人 |
| **测试步骤** | 1. 一个敌人发现玩家<br>2. 验证信息传递给附近敌人<br>3. 验证群体响应 |
| **预期结果** | 发现玩家后通知附近友军 |
| **测试数据** | communicationRange: 15 |

### AI-SNS-009: 伪装检测
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家可伪装 |
| **测试步骤** | 1. 玩家伪装<br>2. 验证检测难度增加<br>3. 解除伪装<br>4. 验证正常检测 |
| **预期结果** | 伪装降低被检测概率 |
| **测试数据** | stealthLevel: 0.5 |

### AI-SNS-010: 感知优先级
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 多个感知源 |
| **测试步骤** | 1. 同时有视觉和听觉刺激<br>2. 验证优先级处理 |
| **预期结果** | 高优先级感知覆盖低优先级 |
| **测试数据** | priority: Visual > Damage > Sound |

---

## 五、战斗AI行为测试 (AI-CBT)

### AI-CBT-001: 攻击选择
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有多种攻击方式 |
| **测试步骤** | 1. 进入攻击范围<br>2. 验证攻击选择逻辑<br>3. 多次测试验证随机性 |
| **预期结果** | 根据距离/冷却选择合适的攻击 |
| **测试数据** | attacks: [Melee, Ranged, Special] |

### AI-CBT-002: 攻击预判
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有预判能力 |
| **测试步骤** | 1. 玩家移动<br>2. 敌人发射投射物<br>3. 验证瞄准玩家前方 |
| **预期结果** | 投射物瞄准玩家移动方向 |
| **测试数据** | leadFactor: 0.5 |

### AI-CBT-003: 躲避行为
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人可躲避 |
| **测试步骤** | 1. 玩家瞄准敌人<br>2. 验证敌人躲避<br>3. 验证躲避方向 |
| **预期结果** | 检测到威胁时躲避 |
| **测试数据** | dodgeChance: 0.3 |

### AI-CBT-004: 掩体使用
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 场景有掩体 |
| **测试步骤** | 1. 玩家射击<br>2. 验证敌人寻找掩体<br>3. 验证在掩体后停留 |
| **预期结果** | 受到攻击时寻找掩体 |
| **测试数据** | coverSearchRange: 10 |

### AI-CBT-005: 战术撤退
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人生命值低 |
| **测试步骤** | 1. 将敌人打到低血量<br>2. 验证撤退行为<br>3. 验证寻找治疗 |
| **预期结果** | 低血量时撤退或求援 |
| **测试数据** | retreatThreshold: 0.2 |

### AI-CBT-006: 包围战术
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 多个敌人同时战斗 |
| **测试步骤** | 1. 触发多个敌人战斗<br>2. 验证分散站位<br>3. 验证包围玩家 |
| **预期结果** | 多个敌人形成包围 |
| **测试数据** | squadSize: 3 |

### AI-CBT-007: 连击应对
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 玩家连续攻击 |
| **测试步骤** | 1. 玩家连续攻击<br>2. 验证敌人格挡/反击<br>3. 验证硬直恢复 |
| **预期结果** | 有应对连击的机制 |
| **测试数据** | comboThreshold: 3 |

### AI-CBT-008: 技能冷却管理
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有特殊技能 |
| **测试步骤** | 1. 敌人使用技能<br>2. 验证冷却期间不使用<br>3. 冷却后再次使用 |
| **预期结果** | 正确管理技能冷却 |
| **测试数据** | skillCooldown: 10s |

### AI-CBT-009: 仇恨值系统
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 多人游戏或有召唤物 |
| **测试步骤** | 1. 多个目标造成伤害<br>2. 验证仇恨值计算<br>3. 验证攻击最高仇恨目标 |
| **预期结果** | 攻击造成最多伤害的目标 |
| **测试数据** | aggroDecay: 1/s |

### AI-CBT-010: 战斗姿态切换
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有多种战斗姿态 |
| **测试步骤** | 1. 战斗中切换条件<br>2. 验证姿态切换<br>3. 验证属性变化 |
| **预期结果** | 根据战况切换姿态 |
| **测试数据** | stances: [Aggressive, Defensive, Balanced] |

### AI-CBT-011: 攻击预警
**优先级:** P0 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人攻击有预警 |
| **测试步骤** | 1. 敌人准备攻击<br>2. 验证预警指示器<br>3. 验证预警后攻击 |
| **预期结果** | 攻击前有可见预警 |
| **测试数据** | warningTime: 1s |

### AI-CBT-012: 弱点暴露
**优先级:** P1 | **类型:** 功能测试

| 项目 | 内容 |
|------|------|
| **前置条件** | 敌人有弱点机制 |
| **测试步骤** | 1. 敌人攻击后<br>2. 验证弱点暴露<br>3. 验证弱点期间受到额外伤害 |
| **预期结果** | 攻击后短暂暴露弱点 |
| **测试数据** | vulnerableDuration: 2s, damageBonus: 1.5 |

---

## 测试数据需求

### 敌人配置数据
```json
{
  "enemies": [
    {
      "name": "TestDeepJellyfish",
      "type": "DeepJellyfish",
      "maxHealth": 50,
      "moveSpeed": 2,
      "detectionRange": 5,
      "attackRange": 3,
      "attackDamage": 10,
      "attackCooldown": 2,
      "behaviors": ["Float", "TentacleAttack"]
    },
    {
      "name": "TestSecurityDrone",
      "type": "SecurityDrone",
      "maxHealth": 80,
      "moveSpeed": 4,
      "detectionRange": 12,
      "attackRange": 15,
      "attackDamage": 8,
      "attackCooldown": 0.5,
      "behaviors": ["Patrol", "LaserAttack", "Alert"]
    },
    {
      "name": "TestAnglerFish",
      "type": "AnglerFish",
      "maxHealth": 120,
      "moveSpeed": 3,
      "detectionRange": 8,
      "attackRange": 10,
      "attackDamage": 40,
      "attackCooldown": 5,
      "behaviors": ["Camouflage", "DashAttack", "Lure"]
    },
    {
      "name": "TestDefenseTurret",
      "type": "DefenseTurret",
      "maxHealth": 100,
      "moveSpeed": 0,
      "detectionRange": 20,
      "attackRange": 18,
      "attackDamage": 15,
      "attackCooldown": 0.2,
      "behaviors": ["RotateAim", "BurstFire"]
    }
  ]
}
```

### 状态机测试数据
```json
{
  "stateMachine": {
    "states": ["Idle", "Patrol", "Chase", "Attack", "Return", "Stunned", "Death"],
    "transitions": [
      {"from": "Idle", "to": "Patrol", "condition": "timer > 3s"},
      {"from": "Patrol", "to": "Chase", "condition": "playerInRange"},
      {"from": "Chase", "to": "Attack", "condition": "playerInAttackRange"},
      {"from": "Chase", "to": "Patrol", "condition": "lostPlayer"},
      {"from": "Attack", "to": "Chase", "condition": "playerOutOfRange"},
      {"from": "Any", "to": "Stunned", "condition": "takenDamage", "priority": 10},
      {"from": "Any", "to": "Death", "condition": "health <= 0", "priority": 100}
    ]
  }
}
```

---

## 自动化测试覆盖

| 测试用例ID | 自动化状态 | 测试文件 |
|------------|------------|----------|
| AI-FSM-001 ~ 012 | ✅ 已覆盖 | StateMachineTests.cs |
| AI-BEH-001 ~ 015 | ⚠️ 部分覆盖 | EnemyBehaviorTests.cs |
| AI-ENM-JF-001 ~ 004 | ⚠️ 部分覆盖 | EnemyTypeTests.cs |
| AI-ENM-SD-001 ~ 004 | ⚠️ 部分覆盖 | EnemyTypeTests.cs |
| AI-ENM-AF-001 ~ 004 | ⚠️ 部分覆盖 | EnemyTypeTests.cs |
| AI-ENM-DT-001 ~ 004 | ⚠️ 部分覆盖 | EnemyTypeTests.cs |
| AI-SNS-001 ~ 010 | ⚠️ 部分覆盖 | PerceptionSystemTests.cs |
| AI-CBT-001 ~ 012 | ⚠️ 部分覆盖 | CombatAITests.cs |

---

**文档版本:** 1.0  
**创建日期:** 2026-02-26  
**作者:** 测试工程师 Agent  
**审核状态:** 待审核
